(function(e){function t(t){for(var a,o,s=t[0],c=t[1],u=t[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0281":function(e,t,n){"use strict";var a=n("a3f7"),r=n.n(a);r.a},"0ab3":function(e,t,n){"use strict";var a=n("bed4"),r=n.n(a);r.a},"0dca":function(e,t,n){},1046:function(e,t,n){},"27eee":function(e,t,n){"use strict";var a=n("aa74"),r=n.n(a);r.a},"3fb3":function(e,t,n){"use strict";var a=n("7627"),r=n.n(a);r.a},4236:function(e,t,n){},4361:function(e,t,n){},4678:function(e,t,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id="4678"},4998:function(e,t,n){},"527f":function(e,t,n){"use strict";var a=n("1046"),r=n.n(a);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("a026"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("router-view")],1)},i=[],o={name:"app",components:{},data:function(){return{collapsed:!1}},mounted:function(){},methods:{}},s=o,c=n("2877"),u=Object(c["a"])(s,r,i,!1,null,null,null),l=u.exports,d=n("f23d"),f=n("0631"),p=n.n(f),m=n("4fe3"),h=(n("202f"),n("70ea"),n("8c4f")),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-layout",{staticStyle:{"min-height":"100vh"},attrs:{id:"components-layout-demo-side"}},[n("a-layout-sider",{attrs:{collapsible:""},model:{value:e.collapsed,callback:function(t){e.collapsed=t},expression:"collapsed"}},[n("div",{staticClass:"logo"},[e._v(e._s(e.name))]),n("a-menu",{attrs:{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"}},[n("a-sub-menu",{key:"sub1"},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a-icon",{attrs:{type:"notification"}}),n("span",[e._v("知晓理工")])],1),n("a-menu-item",{key:"5"},[n("router-link",{attrs:{to:"/sites"}},[e._v("地点")])],1)],1),n("a-sub-menu",{key:"sub2"},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a-icon",{attrs:{type:"home"}}),n("span",[e._v("理工小铺")])],1),n("a-menu-item",{key:"2"},[n("router-link",{attrs:{to:"/goodsType"}},[e._v("类型管理")])],1),n("a-menu-item",{key:"3"},[n("router-link",{attrs:{to:"/goodsExamine"}},[e._v("物品审核")])],1),n("a-menu-item",{key:"4"},[n("router-link",{attrs:{to:"/isStudentExamine"}},[e._v("实名审核")])],1)],1),n("a-sub-menu",{key:"sub5"},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a-icon",{attrs:{type:"coffee"}}),n("span",[e._v("图片")])],1),n("a-menu-item",{key:"7"},[n("router-link",{attrs:{to:"/album"}},[e._v("相册")])],1)],1),n("a-sub-menu",{key:"sub3"},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a-icon",{attrs:{type:"tool"}}),n("span",[e._v("工具")])],1),n("a-menu-item",{key:"6"},[n("router-link",{attrs:{to:"/voice"}},[e._v("语音合成")])],1)],1),n("a-sub-menu",{key:"sub4"},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a-icon",{attrs:{type:"rocket"}}),n("span",[e._v("实验室")])],1),n("a-menu-item",{key:"1"},[n("router-link",{attrs:{to:"/demo"}},[e._v("通讯测试")])],1),n("a-menu-item",{key:"8"},[n("router-link",{attrs:{to:"/md2json"}},[e._v("md2json")])],1)],1)],1)],1),n("a-layout",[n("a-layout-header",{staticClass:"flex-row flex-end  flex-items-center pr50",staticStyle:{background:"#fff"}},[n("a-button",{attrs:{icon:"poweroff"},on:{click:e.logOut}},[e._v("\n        退出登录\n      ")])],1),n("a-layout-content",{staticStyle:{margin:"0 16px"}},[n("div",{style:{padding:"24px",background:"#fff",minHeight:"360px",margin:"16px 0"}},[n("router-view")],1)]),n("a-layout-footer",{staticStyle:{"text-align":"center"}},[e._v("\n      DevNet ©2018 Created by Songxingguo\n    ")])],1)],1)},b=[],g=(n("8e6e"),n("ac6a"),n("456d"),n("a481"),n("bd86")),y=n("bc3a"),k=n.n(y),x={apiUrlOfCloud:"https://api.weixin.qq.com/foo",apiBaseUrl:"https://net.songxingguo.workers.dev"},w=x;function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _="access_token",S=R();function C(e){window.localStorage.setItem(_,e),S=R()}function T(){window.localStorage.removeItem(_),S=R()}function R(){return window.localStorage.getItem(_)}var D=function(e){e.pagination=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.current,a=void 0===n?1:n,r=t.pageSize,i=void 0===r?20:r;return{get:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.params=O({},n.params,{currentPage:a,pageSize:i}),e.get(t,n)}}}};function I(e){var t=e.baseURL,n=e.data,a={},r={},i=k.a.create({withCredentials:!1,baseURL:t,headers:a,params:r,data:n});return i.interceptors.request.use((function(e){return S&&(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.params={token:S}),e}),(function(e){return Promise.reject(e)})),i.interceptors.response.use((function(e){var t=e.data;return 42001!=t.errcode&&41001!=t.errcode&&40014!=t.errcode||(T(),window.$VueRouter.replace("/login")),!1===t.success?Promise.reject(new Error(t.message||"逻辑异常")):{data:t,_response:e}}),(function(e){return Promise.reject(e)})),D(i),i}var P=I({baseURL:w.apiBaseUrl}),$=P,L={data:function(){return{collapsed:!1}},components:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{logOut:function(){this.AV.User.logOut(),T(),this.$router.push({path:"/login"})}},computed:{name:function(){return this.collapsed?"结网":"临渊羡鱼，不如退而结网"}},watch:{}},A=L,E=(n("86a1"),Object(c["a"])(A,v,b,!1,null,"52d3753e",null)),N=E.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("a-button",{attrs:{type:"primary"},on:{click:e.TomSend}},[e._v("Tom发送")]),n("a-button",{attrs:{type:"primary"},on:{click:e.TomReceive}},[e._v("Tom接收")])],1),n("div",[n("a-button",{attrs:{type:"primary"},on:{click:e.JerryReceive}},[e._v("Jerry发送")]),n("a-button",{attrs:{type:"primary"},on:{click:e.JerrySend}},[e._v("Jerry接收")])],1),n("div",[e._v(e._s(e.access_token))]),n("div",[e._v(e._s(e.info))])])},z=[],q=(n("96cf"),n("3b8d")),M={data:function(){return{tom:null,jerry:null,info:null,access_token:""}},components:{},created:function(){},mounted:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){i.$axios.get("https://net.songxingguo.workers.dev/wx/token").then((function(t){e(t)}))}));case 2:return t=e.sent,n=t.access_token,e.next=6,new Promise((function(e){i.$axios.get("https://net.songxingguo.workers.dev/coll?access_token=".concat(n)).then((function(t){e(t)}))}));case 6:a=e.sent,r=a.sites,console.log(r),this.info=r;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){},methods:{TomSend:function(){var e=n("4fe3"),t=e.TextMessage;this.realtime.createIMClient("Tom").then((function(e){return this.tom=e,e.createConversation({members:["Jerry"],name:"Tom & Jerry",unique:!0})})).then((function(e){return e.send(new t("耗子，起床！！"))})).then((function(e){console.log("Tom & Jerry","发送成功！")})).catch(console.error)},TomReceive:function(){var e=n("4fe3"),t=e.Event;this.tom.on(t.MESSAGE,(function(e,t){console.log("Tom Message received: "+e.text)}))},JerrySend:function(){var e=n("4fe3"),t=e.TextMessage;this.tom.send(new t("耗！！"))},JerryReceive:function(){var e=n("4fe3"),t=e.Event;this.realtime.createIMClient("Jerry").then((function(e){e.on(t.MESSAGE,(function(e,t){console.log("Message received: "+e.text)}))})).catch(console.error)},getAccessToken:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){a.$axios.get("https://net.songxingguo.workers.dev/wx/token").then((function(t){e(t)}))}));case 2:t=e.sent,n=t.access_token,this.access_token=n;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},computed:{},watch:{}},V=M,F=(n("9806"),Object(c["a"])(V,U,z,!1,null,"5349349d",null)),J=F.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-upload",{attrs:{name:"file",multiple:!0,action:"https://net.songxingguo.workers.dev/test/md"},on:{change:e.handleChange}},[n("a-button",[n("a-icon",{attrs:{type:"upload"}}),e._v("\n    Click to Upload\n  ")],1)],1)},K=[],Y=(n("7f7f"),{data:function(){return{}},components:{},created:function(){},mounted:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){},methods:{handleChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?this.$message.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," file upload failed."))}},computed:{},watch:{}}),H=Y,W=(n("e823"),Object(c["a"])(H,G,K,!1,null,"9dd68e3c",null)),B=W.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-button",{staticClass:"mb20",attrs:{type:"primary"},on:{click:e.showModal}},[e._v("新增")]),n("collection-create-form",{ref:"collectionForm",attrs:{visible:e.visible},on:{cancel:e.handleCancel,create:e.handleCreate}}),n("a-table",{attrs:{columns:e.columns,dataSource:e.data,bordered:"",rowKey:function(e){return e.id}},scopedSlots:e._u([e._l(["name"],(function(t){return{key:t,fn:function(a,r){return[n("div",{key:t},[r.editable?n("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:a},on:{change:function(n){return e.handleChange(n.target.value,r.key,t)}}}):[e._v(e._s(a))]],2)]}}})),{key:"operation",fn:function(t,a){return[n("div",{staticClass:"editable-row-operations"},[a.editable?n("span",[n("a",{on:{click:function(){return e.save(a.key)}}},[e._v("保存")]),n("a-popconfirm",{attrs:{title:"确认要取消?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.cancel(a.key)}}},[n("a",[e._v("取消")])])],1):n("span",[n("a",{on:{click:function(){return e.edit(a.key)}}},[e._v("编辑")])]),n("a-divider",{attrs:{type:"vertical"}}),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteType(a.id)}}},[n("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},Q=[],Z=(n("7514"),n("75fc"));n("6b54");function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=[{title:"名称",dataIndex:"name",width:"70%"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],ae={props:["visible"],beforeCreate:function(){this.form=this.$form.createForm(this)},template:"\n  <a-modal\n    :visible=\"visible\"\n    title='新增类型'\n    okText='新增'\n    cancelText=\"取消\"\n    @cancel=\"() => { $emit('cancel') }\"\n    @ok=\"() => { $emit('create') }\"\n  >\n    <a-form layout='vertical' :form=\"form\">\n      <a-form-item label='名称'>\n        <a-input\n          v-decorator=\"[\n            'name',\n            {\n              rules: [{ required: true, message: '请输入名称' }],\n            }\n          ]\"\n          @keyup.enter=\"() => { $emit('create') }\"\n        />\n      </a-form-item>\n    </a-form>\n  </a-modal>\n"},re={data:function(){return{columns:ne,data:[],visible:!1}},components:{CollectionCreateForm:ae},created:function(){},mounted:function(){var e=this;this.loadTypes((function(t){e.data=t.map((function(e,t){return Object.assign({},te({},e.attributes),{id:e.id},{key:t.toString()})}))}))},beforeDestroy:function(){},methods:{handleChange:function(e,t,n){var a=Object(Z["a"])(this.data),r=a.filter((function(e){return t===e.key}))[0];r&&(r[n]=e,this.data=a)},edit:function(e){var t=Object(Z["a"])(this.data),n=t.filter((function(t){return e===t.key}))[0];n&&(n.editable=!0,this.data=t)},save:function(e){var t=Object(Z["a"])(this.data),n=t.filter((function(t){return e===t.key}))[0];n&&(delete n.editable,this.data=t,this.cacheData=t.map((function(e){return te({},e)})),this.editType(n))},cancel:function(e){var t=Object(Z["a"])(this.data),n=t.filter((function(t){return e===t.key}))[0];n&&(Object.assign(n,this.cacheData.filter((function(t){return e===t.key}))[0]),delete n.editable,this.data=t)},showModal:function(){this.visible=!0},handleCancel:function(){this.visible=!1},handleCreate:function(){var e=this,t=this.$refs.collectionForm.form;t.validateFields((function(n,a){n||(e.createType(a),t.resetFields(),e.visible=!1)}))},loadTypes:function(e){var t=this.AV,n=new t.Query("GoodsTypes");n.ascending("createdAt"),n.find().then((function(t){e(t)})).catch((function(e){alert(JSON.stringify(e))}))},createType:function(e){var t=this,n=e.name,a=this.AV.Object.extend("GoodsTypes"),r=new a;r.set("name",n),r.save().then((function(){t.$message.success("新增成功",1),t.loadTypes((function(e){t.data=e.map((function(e,t){return Object.assign({},te({},e.attributes),{id:e.id},{key:t.toString()})}))}))}),(function(e){console.error(e)}))},editType:function(e){var t=this,n=this.AV.Object.createWithoutData("GoodsTypes",e.id);n.set("name",e.name),n.save().then((function(){t.$message.success("修改成功",1)}))},deleteType:function(e){var t=this,n=this.AV.Object.createWithoutData("GoodsTypes",e);n.destroy().then((function(){t.$message.success("删除成功",1),t.loadTypes((function(e){t.data=e.map((function(e,t){return Object.assign({},te({},e.attributes),{id:e.id},{key:t.toString()})}))}))}),(function(e){console.error(e)}))}},computed:{},watch:{}},ie=re,oe=(n("3fb3"),Object(c["a"])(ie,X,Q,!1,null,"8f317e0a",null)),se=oe.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-table",{attrs:{columns:e.columns,dataSource:e.data,bordered:"",rowKey:function(e){return e.id}},scopedSlots:e._u([{key:"images",fn:function(t){return n("div",{staticClass:"flex-row flex-space-around"},e._l(t,(function(e){return n("PreviewImage",{key:e.id,attrs:{src:e.attributes.url}})})),1)}},{key:"state",fn:function(t){return[n("a",0==t?[e._v("待审核")]:1==t?[e._v("审核通过")]:[e._v("审核未通过")])]}},{key:"operation",fn:function(t,a){return[n("div",{staticClass:"editable-row-operations"},[0==a.isPassed?n("span",[n("a-popconfirm",{attrs:{title:"确认通过审核?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.passExamine(a.id)}}},[n("a",[e._v("通过")])]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return e.showModal(a)}}},[e._v("不通过")]),n("a-divider",{attrs:{type:"vertical"}})],1):e._e(),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteGoods(a.id)}}},[n("a",[e._v("删除")])])],1)]}}])}),n("collection-create-form",{ref:"collectionForm",attrs:{visible:e.visible,record:e.record},on:{cancel:e.handleCancel,create:e.handleCreate}})],1)},ue=[],le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preview-image"},[n("a-tooltip",{attrs:{placement:"right",overlayClassName:"tooltip--image",mouseEnterDelay:.3}},[n("template",{slot:"title"},[e.src?n("img",{staticClass:"preview-image--ori",attrs:{src:e.src,alt:"封面"}}):e._e()]),e.src?n("img",{staticClass:"preview-image--item preview-image--mini",attrs:{src:e.src,alt:"封面"}}):e._e()],2)],1)},de=[],fe={name:"preview-image",props:{src:{type:String,default:null}},data:function(){return{}},components:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{},computed:{},watch:{}},pe=fe,me=(n("0ab3"),Object(c["a"])(pe,le,de,!1,null,"f1240f2a",null)),he=me.exports;function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge=[{title:"标题",dataIndex:"title",width:"10%"},{title:"内容",dataIndex:"content",width:"15%"},{title:"物品图片",dataIndex:"imgList",width:"25%",scopedSlots:{customRender:"images"}},{title:"类型",dataIndex:"type.attributes.name",width:"10%"},{title:"价格",dataIndex:"price",width:"10%",scopedSlots:{customRender:"price"}},{title:"状态",dataIndex:"isPassed",width:"10%",scopedSlots:{customRender:"state"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],ye={props:["visible","record"],beforeCreate:function(){this.form=this.$form.createForm(this)},template:"\n  <a-modal\n    :visible=\"visible\"\n    title='审核建议'\n    okText='提交'\n    cancelText=\"取消\"\n    @cancel=\"() => { $emit('cancel') }\"\n    @ok=\"() => { $emit('create', record) }\"\n  >\n    <a-form layout='vertical' :form=\"form\">\n      <a-form-item label='建议'>\n        <a-textarea\n          placeholder=\"存在的问题、改进建议\"\n          v-decorator=\"[\n              'suggest',\n              {\n                rules: [{ required: true, message: '请输入审核建议' }],\n              }\n            ]\"\n            :rows=\"8\"\n            @keyup.enter=\"() => { $emit('create', record)}\"/>\n      </a-form-item>\n    </a-form>\n  </a-modal>\n"},ke=-1,xe=1,we=0,je={data:function(){return{columns:ge,data:[],visible:!1,record:null}},components:{PreviewImage:he,CollectionCreateForm:ye},created:function(){},mounted:function(){var e=this;this.loadGoodsList((function(t){e.data=t.map((function(e,t){return Object.assign({},be({},e.attributes),{id:e.id},{key:t.toString()})}))}))},beforeDestroy:function(){},methods:{showModal:function(e){this.visible=!0,this.record=e},handleCancel:function(){this.visible=!1},handleCreate:function(e){var t=this,n=this.$refs.collectionForm.form;n.validateFields((function(a,r){a||(t.notPassExamine(e.id),t.createNotice(Object.assign(be({},r),be({},e))),n.resetFields(),t.visible=!1)}))},loadGoodsList:function(e){var t=this.AV,n=new t.Query("Goods");n.ascending("createdAt"),n.include("owner"),n.include("imgList"),n.include("type"),n.equalTo("isDelete",!1),n.find().then((function(t){e(t)})).catch((function(e){alert(JSON.stringify(e))}))},deleteGoods:function(e){var t=this,n=this.AV.Object.createWithoutData("Goods",e);n.destroy().then((function(){t.$message.success("删除成功",1),t.loadGoodsList((function(e){t.data=e.map((function(e,t){return Object.assign({},be({},e.attributes),{id:e.id},{key:t.toString()})}))}))}),(function(e){console.error(e)}))},passExamine:function(e){var t=this,n=this.AV.Object.createWithoutData("Goods",e);n.set("isPassed",xe),n.save().then((function(){t.$message.success("审核通过",1)})),this.loadGoodsList((function(e){t.data=e.map((function(e,t){return Object.assign({},be({},e.attributes),{id:e.id},{key:t.toString()})}))}))},notPassExamine:function(e){var t=this,n=this.AV.Object.createWithoutData("Goods",e);n.set("isPassed",ke),n.save().then((function(){t.$message.success("审核不通过",1),t.loadGoodsList((function(e){t.data=e.map((function(e,t){return Object.assign({},be({},e.attributes),{id:e.id},{key:t.toString()})}))}))}))},createNotice:function(e){var t=this,n=e.suggest,a=(e.owner,this.AV.Object.extend("Notices")),r=new a;r.set("content",n),r.set("sendTime",new Date),r.save().then((function(e){var n=t.AV.Object.extend("UserNotices"),a=new n;a.set("isRead",we),a.set("notice",e),a.save().then((function(){t.$message.success("已通知用户",1)}),(function(e){console.error(e)}))}),(function(e){console.error(e)}))}},computed:{},watch:{}},Oe=je,_e=(n("db00"),Object(c["a"])(Oe,ce,ue,!1,null,"7ba08066",null)),Se=_e.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-table",{attrs:{columns:e.columns,dataSource:e.data,bordered:"",rowKey:function(e){return e.id}},scopedSlots:e._u([{key:"images",fn:function(t){return n("div",{staticClass:"preview-image flex-row flex-space-around"},e._l(t,(function(t){return n("a-tooltip",{key:t.id,attrs:{placement:"right",overlayClassName:"tooltip--image",mouseEnterDelay:.3}},[n("template",{slot:"title"},[t.attributes.url?n("img",{staticClass:"preview-image--ori",attrs:{src:t.attributes.url,alt:"证件图片"}}):e._e()]),t.attributes.url?n("img",{staticClass:"preview-image--item preview-image--mini",attrs:{src:t.attributes.url,alt:"证件图片"}}):e._e()],2)})),1)}},{key:"state",fn:function(t){return[n("a",0==t?[e._v("待审核")]:1==t?[e._v("审核通过")]:[e._v("审核未通过")])]}},{key:"operation",fn:function(t,a){return[n("div",{staticClass:"editable-row-operations"},[0==a.isPassed?n("span",[n("a-popconfirm",{attrs:{title:"确认通过审核?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.passExamine(a.id)}}},[n("a",[e._v("通过")])]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return e.showModal(a)}}},[e._v("不通过")]),n("a-divider",{attrs:{type:"vertical"}})],1):e._e(),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteRealInfo(a.id)}}},[n("a",[e._v("删除")])])],1)]}}])}),n("collection-create-form",{ref:"collectionForm",attrs:{visible:e.visible,record:e.record},on:{cancel:e.handleCancel,create:e.handleCreate}})],1)},Te=[];function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=[{title:"真实姓名",dataIndex:"name",width:"15%"},{title:"身份证号",dataIndex:"IDNum",width:"20%"},{title:"证件图片",dataIndex:"imgList",width:"30%",scopedSlots:{customRender:"images"}},{title:"状态",dataIndex:"isPassed",width:"15%",scopedSlots:{customRender:"state"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],Pe={props:["visible","record"],beforeCreate:function(){this.form=this.$form.createForm(this)},template:"\n  <a-modal\n    :visible=\"visible\"\n    title='审核建议'\n    okText='提交'\n    cancelText=\"取消\"\n    @cancel=\"() => { $emit('cancel') }\"\n    @ok=\"() => { $emit('create', record) }\"\n  >\n    <a-form layout='vertical' :form=\"form\">\n      <a-form-item label='建议'>\n        <a-textarea\n          placeholder=\"存在的问题、改进建议\"\n          v-decorator=\"[\n              'suggest',\n              {\n                rules: [{ required: true, message: '请输入审核建议' }],\n              }\n            ]\"\n            :rows=\"8\"\n            @keyup.enter=\"() => { $emit('create', record)}\"/>\n      </a-form-item>\n    </a-form>\n  </a-modal>\n"},$e=-1,Le=1,Ae=0,Ee={data:function(){return{columns:Ie,data:[],visible:!1,record:null}},components:{CollectionCreateForm:Pe},created:function(){},mounted:function(){var e=this;this.loadRealInfos((function(t){e.data=t.map((function(e,t){return Object.assign({},De({},e.attributes),{id:e.id},{key:t.toString()})}))}))},beforeDestroy:function(){},methods:{showModal:function(e){this.visible=!0,this.record=e},handleCancel:function(){this.visible=!1},handleCreate:function(e){var t=this,n=this.$refs.collectionForm.form;n.validateFields((function(a,r){a||(t.notPassExamine(e.id),t.createNotice(Object.assign(De({},r),De({},e))),n.resetFields(),t.visible=!1)}))},loadRealInfos:function(e){var t=this.AV,n=new t.Query("RealInfo");n.ascending("createdAt"),n.include("imgList"),n.equalTo("isDelete",!1),n.find().then((function(t){e(t)})).catch((function(e){alert(JSON.stringify(e))}))},deleteRealInfo:function(e){var t=this,n=this.AV.Object.createWithoutData("RealInfo",e);n.destroy().then((function(){t.$message.success("删除成功",1),t.loadRealInfos((function(e){t.data=e.map((function(e,t){return Object.assign({},De({},e.attributes),{id:e.id},{key:t.toString()})}))}))}),(function(e){console.error(e)}))},passExamine:function(e){var t=this,n=this.AV.Object.createWithoutData("RealInfo",e);n.set("isPassed",Le),n.save().then((function(){t.$message.success("审核通过",1),t.loadRealInfos((function(e){t.data=e.map((function(e,t){return Object.assign({},De({},e.attributes),{id:e.id},{key:t.toString()})}))}))}))},notPassExamine:function(e){var t=this,n=this.AV.Object.createWithoutData("RealInfo",e);n.set("isPassed",$e),n.save().then((function(){t.$message.success("审核不通过",1),t.loadRealInfos((function(e){t.data=e.map((function(e,t){return Object.assign({},De({},e.attributes),{id:e.id},{key:t.toString()})}))}))}))},createNotice:function(e){var t=this,n=e.suggest,a=(e.owner,this.AV.Object.extend("Notices")),r=new a;r.set("content",n),r.set("sendTime",new Date),r.save().then((function(e){var n=t.AV.Object.extend("UserNotices"),a=new n;a.set("isRead",Ae),a.set("notice",e),a.save().then((function(){t.$message.success("已通知用户",1)}),(function(e){console.error(e)}))}),(function(e){console.error(e)}))}},computed:{},watch:{}},Ne=Ee,Ue=(n("5c72"),Object(c["a"])(Ne,Ce,Te,!1,null,"dc19be28",null)),ze=Ue.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-button",{staticClass:"mb20",attrs:{type:"primary"},on:{click:e.create}},[e._v("新增")]),n("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:e.pagination,bordered:"",rowKey:function(e){return e.id}},on:{change:e.handleChange},scopedSlots:e._u([{key:"desc",fn:function(e){return[n("tooltip",{attrs:{value:e}})]}},{key:"images",fn:function(t){return n("div",{staticClass:"flex-row flex-all-center flex-wrap"},e._l(t,(function(e,t){return n("preview-image",{key:t,attrs:{src:e.url}})})),1)}},{key:"audioUrl",fn:function(t){return n("audio",{staticClass:"audio",attrs:{src:t,controls:"controls"}},[e._v("\n      您的浏览器不支持 audio 标签。\n    ")])}},{key:"poster",fn:function(e){return n("preview-image",{attrs:{src:e}})}},{key:"operation",fn:function(t,a){return[n("div",{staticClass:"editable-row-operations"},[n("a",{on:{click:function(){return e.edit(a)}}},[e._v("编辑")]),n("a-divider",{attrs:{type:"vertical"}}),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteItem(a)}}},[n("a",[e._v("删除")])])],1)]}}])})],1)},Me=[],Ve=(n("28a5"),n("5df3"),n("d225")),Fe=n("b0b4"),Je=function(){function e(){Object(Ve["a"])(this,e)}return Object(Fe["a"])(e,null,[{key:"getUploadUrl",value:function(e){var t=e.path;return $.post("/tcb/uploadfile",{path:t}).then((function(e){var t=e.data;return t}))}},{key:"getDownloadUrl",value:function(e){if(0!=e.length)return $.post("wx/download",{file_list:this._getFileList(e)}).then((function(e){var t=e.data;return t.file_list.map((function(e,t){var n=e.fileid;return{uid:Date.now()+t,file_id:n,url:e.download_url,name:n.slice(n.lastIndexOf("/")+1),status:"done"}}))}))}},{key:"_getFileList",value:function(e){return e.map((function(e){return{fileid:e,max_age:7200}}))}}]),e}(),Ge=function(){function e(){Object(Ve["a"])(this,e)}return Object(Fe["a"])(e,null,[{key:"list",value:function(e){var t=e.current,n=void 0===t?1:t,a=e.pageSize,r=void 0===a?10:a;return $.post("/wx/query",{query:"db.collection('sites').limit(".concat(r,").skip(").concat((n-1)*r,").get()")}).then((function(e){var t=e.data,n=t.data,a=t.pager;return n?{data:Promise.all(n.map(function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=JSON.parse(t),e.t0=t._id,e.t1=t.title,e.t2={scenic:"景点",dept:"院系",building:"教学楼",dormitory:"宿舍",diningroom:"餐饮",library:"图书馆",site:"场馆",gate:"出入门",atm:"ATM",toilet:"卫生间",service:"服务"}[t.type],e.t3=t.desc.toString(),e.t4=t.position,e.t5=t.location.coordinates.toString(),e.t6=t.audio&&t.audio.name,e.t7=t.audio,!e.t7){e.next=13;break}return e.next=12,Je.getDownloadUrl([t.audio.poster]);case 12:e.t7=e.sent[0];case 13:if(e.t8=e.t7,e.t9=t.audio,!e.t9){e.next=19;break}return e.next=18,Je.getDownloadUrl([t.audio.src]);case 18:e.t9=e.sent[0];case 19:return e.t10=e.t9,e.t11={name:e.t6,poster:e.t8,src:e.t10},e.next=23,Je.getDownloadUrl(t.images);case 23:return e.t12=e.sent,e.abrupt("return",{id:e.t0,title:e.t1,type:e.t2,desc:e.t3,position:e.t4,location:e.t5,audio:e.t11,images:e.t12});case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),pagination:{current:a.Offset,pageSize:a.Limit,total:a.Total}}:{data:[]}}))}},{key:"show",value:function(e){return $.post("/wx/query",{query:'db.collection("sites")\n      .where({_id:'.concat(JSON.stringify(e),"}).get()")}).then(function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.data,a=JSON.parse(n.data),e.abrupt("return",{id:a._id,title:a.title,type:a.type,desc:a.desc.join("\n"),position:a.position,location:a.location.coordinates.toString(),audio:{name:a.audio&&a.audio.name,poster:a.audio&&a.audio.poster,src:a.audio&&a.audio.src},images:a.images});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"edit",value:function(e,t){return $.post("/wx/update",{query:'db.collection("sites").where({_id:'.concat(JSON.stringify(e),"})\n      .update({data: ").concat(this._formatData(t),"})")}).then((function(e){var t=e.data;return t}))}},{key:"create",value:function(e){return $.post("/wx/add",{query:"db.collection('sites')\n      .add({data: ".concat(this._formatData(e),"})")}).then((function(e){var t=e.data;return t}))}},{key:"_formatData",value:function(e){return"{title: ".concat(JSON.stringify(e.title),",\n      type: ").concat(JSON.stringify(e.type),",\n      desc: ").concat(JSON.stringify(e.desc.trim().split(/[\s+\n]/)),',\n      position: "').concat(e.position,'",\n      location: new db.Geo.Point(').concat(e.location.split(",")[0],", ").concat(e.location.split(",")[1],"),\n      audio: ").concat(JSON.stringify(e.audio),",\n      images: ").concat(JSON.stringify(e.images),",\n    }")}},{key:"delete",value:function(e){return $.post("/wx/delete",{query:"db.collection('sites').doc('".concat(e,"').remove()")}).then((function(e){var t=e.data;return t}))}}]),e}(),Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-tooltip",{attrs:{placement:"rightTop"}},[n("template",{slot:"title"},[e._v("\n      "+e._s(e.value)+"\n    ")]),e._v("\n    "+e._s(e._f("more")(e.value,e.maxLen))+"\n  ")],2)],1)},Ye=[],He=(n("c5f6"),{data:function(){return{}},props:{value:{type:String,default:""},maxLen:Number,placement:{type:String,default:"rightTop"}},components:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{},computed:{},watch:{},filters:{more:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e&&e.length>t&&(e=e.substring(0,t)+"..."),e}}}),We=He,Be=(n("27eee"),Object(c["a"])(We,Ke,Ye,!1,null,"42f7b565",null)),Xe=Be.exports,Qe=[{title:"名称",dataIndex:"title"},{title:"类型",dataIndex:"type",width:"8%"},{title:"描述",dataIndex:"desc",scopedSlots:{customRender:"desc"},width:"10%"},{title:"位置",dataIndex:"position"},{title:"经纬度",dataIndex:"location"},{title:"图片",dataIndex:"images",width:"20%",scopedSlots:{customRender:"images"}},{title:"名称",dataIndex:"audio.name"},{title:"海报",dataIndex:"audio.poster.url",scopedSlots:{customRender:"poster"}},{title:"音频",dataIndex:"audio.src.url",scopedSlots:{customRender:"audioUrl"}},{title:"操作",dataIndex:"operation",width:"25%",scopedSlots:{customRender:"operation"}}],Ze={data:function(){return{data:[],pagination:{},columns:Qe,visible:!1,record:null,info:{}}},components:{PreviewImage:he,Tooltip:Xe},created:function(){},mounted:function(){this.loadData()},beforeDestroy:function(){},methods:{handleChange:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.pagination=t,e.next=3,this.loadData();case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),loadData:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ge.list(this.pagination);case 3:if(t=e.sent,n=t.data,a=t.pagination,n){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n;case 10:this.data=e.sent,this.pagination=a,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));function t(){return e.apply(this,arguments)}return t}(),create:function(){this.$router.push("/sites/create")},edit:function(e){var t=e.id;this.$router.push("/sites/".concat(t,"/edit"))},deleteItem:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.id,e.prev=1,e.next=4,Ge.delete(n);case 4:this.$message.success("删除成功！"),this.loadData(),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()},computed:{},watch:{}},et=Ze,tt=(n("0281"),Object(c["a"])(et,qe,Me,!1,null,"4641ce2e",null)),nt=tt.exports,at=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form",[n("a-row",{attrs:{gutter:20}},[n("a-col",{attrs:{span:12}},[n("a-form-item",{attrs:{label:"标题"}},[n("a-input",{model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),n("a-form-item",{attrs:{label:"类型"}},[n("a-select",{attrs:{placeholder:"选择类型"},model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},e._l(e.categories,(function(t){return n("a-select-option",{key:t.code,attrs:{value:t.code}},[e._v(e._s(t.name)+"\n            ")])})),1)],1),n("a-form-item",{attrs:{label:"描述"}},[n("a-textarea",{attrs:{autosize:{minRows:2,maxRows:8}},model:{value:e.model.desc,callback:function(t){e.$set(e.model,"desc",t)},expression:"model.desc"}})],1),n("a-form-item",{attrs:{label:"位置"}},[n("a-input",{model:{value:e.model.position,callback:function(t){e.$set(e.model,"position",t)},expression:"model.position"}})],1),n("a-form-item",{attrs:{label:"经纬度"}},[n("a-input",{model:{value:e.model.location,callback:function(t){e.$set(e.model,"location",t)},expression:"model.location"}}),n("a",{attrs:{href:"https://lbs.amap.com/console/show/picker",target:"_blank"}},[e._v("坐标拾取器")])],1),n("a-form-item",{attrs:{label:"图片"}},[n("upload",{attrs:{size:5},model:{value:e.model.images,callback:function(t){e.$set(e.model,"images",t)},expression:"model.images"}})],1)],1)],1),n("a-divider",{attrs:{orientation:"left"}},[e._v("音频")]),n("a-row",{attrs:{gutter:20}},[n("a-col",{attrs:{span:12}},[n("a-form-item",{attrs:{label:"名称"}},[n("a-input",{model:{value:e.model.audio.name,callback:function(t){e.$set(e.model.audio,"name",t)},expression:"model.audio.name"}})],1)],1)],1),n("a-form-item",{attrs:{label:"音频"}},[n("upload",{attrs:{listType:"text",accept:"audio/*"},model:{value:e.model.audio.src,callback:function(t){e.$set(e.model.audio,"src",t)},expression:"model.audio.src"}})],1),n("a-form-item",{attrs:{label:"海报"}},[n("upload",{model:{value:e.model.audio.poster,callback:function(t){e.$set(e.model.audio,"poster",t)},expression:"model.audio.poster"}})],1),n("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("\n      提交\n    ")])],1)],1)},rt=[],it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-upload"},[n("a-upload",{attrs:{action:e.fullAction,accept:e.accept,listType:e.listType,fileList:e.fileList,data:e.data,beforeUpload:e.beforeUpload},on:{preview:e.handlePreview,change:e.handleChange}},[e.isPictureCard?[e.fileList.length<e.size?n("div",[n("a-icon",{attrs:{type:"plus"}}),n("div",{staticClass:"ant-upload-text"},[e._v("上传")])],1):e._e()]:[n("a-button",[n("a-icon",{attrs:{type:"upload"}}),e._v("\n        上传\n      ")],1)]],2),n("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[n("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)},ot=[],st={name:"upload",props:{value:{type:[Array,String],default:function(){return[]}},size:{type:Number,default:1},listType:{type:String,default:"picture-card"},accept:{type:String,default:"jpg,.png,.jpeg"}},data:function(){return{fullAction:"",previewVisible:!1,previewImage:"",access_token:"",fileList:[],isFirst:!0,data:{}}},components:{},created:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.access_token=R();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){},beforeDestroy:function(){},methods:{handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},handleChange:function(e){var t=e.fileList,n=t.map((function(e){return e.file_id}));this.emitInput(n)},emitInput:function(e){this.$emit("input",this.size>1?e:e[0]||"")},beforeUpload:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Je.getUploadUrl({path:"".concat(t.name)});case 2:n=e.sent,t.file_id=n.file_id,this.fullAction="".concat(w.apiUrlOfCloud).concat(n.url.split(".com")[1]),this.data={key:t.name,Signature:n.authorization,"x-cos-security-token":n.token,"x-cos-meta-fileid":n.cos_file_id};case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},computed:{isPictureCard:function(){return"picture-card"===this.listType}},watch:{value:{handler:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.value,0!==t.length){e.next=3;break}return e.abrupt("return",this.fileList=[]);case 3:return n="string"===typeof t?[t]:t,e.next=6,Je.getDownloadUrl(n);case 6:a=e.sent,this.fileList=a;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}}},ct=st,ut=(n("b8eb"),Object(c["a"])(ct,it,ot,!1,null,"13be1698",null)),lt=ut.exports,dt={data:function(){return{model:{title:"",type:void 0,desc:"",position:"",location:"",audio:{name:"",poster:"",src:""},images:[]},categories:[{name:"景点",code:"scenic"},{name:"院系",code:"dept"},{name:"教学楼",code:"building"},{name:"宿舍",code:"dormitory"},{name:"餐饮",code:"diningroom"},{name:"图书馆",code:"library"},{name:"场馆",code:"site"},{name:"出入门",code:"gate"},{name:"ATM",code:"atm"},{name:"卫生间",code:"toilet"},{name:"服务",code:"service"}],loading:!1,siteId:void 0}},components:{upload:lt},created:function(){this.siteId=this.$route.params.id,this.siteId&&this.loadEditData(this.siteId)},mounted:function(){},beforeDestroy:function(){},methods:{loadEditData:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ge.show(t);case 2:this.model=e.sent,console.log(this.model);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),submit:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.isUpdate){e.next=6;break}return e.next=4,Ge.edit(this.siteId,this.model);case 4:e.next=8;break;case 6:return e.next=8,Ge.create(this.model);case 8:this.$message.success("新增成功！"),this.back(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}(),back:function(){var e=this;setTimeout((function(){e.$router.replace("/sites")}),800)}},computed:{isUpdate:function(){return void 0!==this.siteId}},watch:{}},ft=dt,pt=(n("72ed"),Object(c["a"])(ft,at,rt,!1,null,"6de08468",null)),mt=pt.exports,ht=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container"},[n("a-row",{staticClass:"login-content",attrs:{type:"flex",justify:"center"}},[n("a-col",{attrs:{span:12}},[n("div",{staticClass:"login-panel"},[n("div",{staticClass:"login-panel--title"},[e._v("\n          后台管理\n        ")]),n("a-form",{staticClass:"login-form",attrs:{form:e.form,layout:"vertical"},on:{submit:e.login}},[n("a-form-item",{attrs:{label:"手机号"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{rules:[{required:!0,message:"请输入手机号"},{pattern:/^1([38]\d|5[0-35-9]|7[3678])\d{8}$/,message:"请输入正确手机号"}]}],expression:"[\n                'phone',\n                {\n                  rules: [{ required: true, message: '请输入手机号' },\n                  {pattern: /^1([38]\\d|5[0-35-9]|7[3678])\\d{8}$/, message: '请输入正确手机号'}],\n                }\n              ]"}],attrs:{size:"large"}})],1),n("a-form-item",{attrs:{label:"验证码"}},[n("a-row",{attrs:{gutter:8}},[n("a-col",{attrs:{span:16}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",{rules:[{required:!0,message:"请输入验证码"},{len:6,message:"请输入正确验证码"}]}],expression:"[\n                    'captcha',\n                    {rules: [{ required: true, message: '请输入验证码' },\n                    {len: 6, message: '请输入正确验证码'}]}\n                  ]"}],attrs:{size:"large"}})],1),n("a-col",{attrs:{span:8}},[n("a-button",{staticClass:"login-btn",attrs:{type:"primary",size:"large",disabled:e.disabled},on:{click:e.getSmsCode}},[e._v("\n                  "+e._s(e.maxtime?e.maxtime+" s":"获取验证码")+"\n                ")])],1)],1)],1),n("a-form-item",[n("a-button",{staticClass:"login-btn",attrs:{type:"primary",size:"large","html-type":"submit"}},[e._v("\n              登录\n            ")])],1)],1)],1)])],1)],1)},vt=[],bt=function(){function e(){Object(Ve["a"])(this,e)}return Object(Fe["a"])(e,null,[{key:"getAccessToken",value:function(){return $.get("/wx/token").then((function(e){var t=e.data;return t}))}}]),e}(),gt={data:function(){return{form:this.$form.createForm(this),loading:!1,maxtime:null,timer:null,disabled:!1}},components:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{getSmsCode:function(e){var t=this;e.preventDefault(),this.form.validateFields(["phone"],(function(e,n){var a=n.phone;e||t.AV.Cloud.requestSmsCode(a).then((function(){t.$message.success("验证码已发送",1),t.disabled=!0,t.maxtime=60,t.timer=setInterval((function(){t.maxtime>=0?t.maxtime=t.maxtime-1:(t.maxtime=null,t.disabled=!1,clearInterval(t.timer))}),1e3)}),(function(e){console.error(e)}))}))},login:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n,a,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,bt.getAccessToken();case 3:n=e.sent,a=n.access_token,C(a),this.form.validateFields((function(e,t){var n=t.phone,a=t.captcha;e||r.AV.User.signUpOrlogInWithMobilePhone(n,a).then((function(){r.$router.push({path:"/"})}),(function(){r.$message.success("验证码错误",1)}))}));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},computed:{},watch:{}},yt=gt,kt=(n("527f"),Object(c["a"])(yt,ht,vt,!1,null,"381e3a74",null)),xt=kt.exports,wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form",[n("a-form-item",{attrs:{label:"请输入需要合成的文案（随机示例）"}},[n("a-textarea",{attrs:{placeholder:e.placeholderText,rows:6},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1),n("a-form-item",{attrs:{label:"发音人"}},[n("a-radio-group",{model:{value:e.voiceName,callback:function(t){e.voiceName=t},expression:"voiceName"}},[n("a-radio",{attrs:{value:"x_ningning"}},[e._v("讯飞宁宁")]),n("a-radio",{attrs:{value:"xiaoyan"}},[e._v("小燕")])],1)],1),n("a-button",{attrs:{type:"primary"},on:{click:e.play}},[n("a-icon",{attrs:{type:e.iconType}}),e._v("\n      播放\n    ")],1),n("a-button",{staticClass:"ml-s",on:{click:e.download}},[n("a-icon",{attrs:{type:"download"}}),e._v("\n      下载\n    ")],1)],1)],1)},jt=[],Ot=n("27ae"),_t=n("8237"),St=n.n(_t),Ct=function(e,t){var n=document.createElement("a");n.download=t,n.style.display="none",n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)},Tt="科大讯飞成立于1999年，是中国先进的智能化语音技术提供商，其语音核心技术代表世界先进水平。我们提供的语音合成效果，达到了真正可商用的标准，您可以在这里输入任意文本进行语音合成体验。",Rt={data:function(){return{text:"",url:"",voiceName:"x_ningning",audio:null,placeholderText:Tt,blobUrl:"",paused:!0}},components:{},created:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.audio=new Audio;case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){},destroyed:function(){this.audio.pause(),this.audio=null},methods:{getVoice:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="5c308e57",n="13c1a7ef9bde624e183ef8051074d5a2",a=Math.round(new Date/1e3),r=Ot["Base64"].encode('{\n        "auf": "audio/L16;rate=16000",\n        "aue": "lame",\n        "voice_name": '.concat(JSON.stringify(this.voiceName),',\n        "speed": "50",\n        "volume": "50",\n        "pitch": "50",\n        "engine_type": "intp65",\n        "text_type": "text"\n      }')),i=St()("".concat(n).concat(a).concat(r)),e.prev=5,e.next=8,this.axios({method:"post",headers:{"X-Appid":t,"X-CurTime":a,"X-Param":r,"X-CheckSum":i,"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},url:"/xfyun/v1/service/v1/tts",params:{text:this.text?this.text:Tt},responseType:"blob"});case 8:if(o=e.sent,s=o.data,"text/plain"!==s.type){e.next=12;break}return e.abrupt("return",console.error(s));case 12:this.blobUrl=URL.createObjectURL(s),this.audio.src=this.blobUrl,e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](5),console.error(e.t0);case 19:case"end":return e.stop()}}),e,this,[[5,16]])})));function t(){return e.apply(this,arguments)}return t}(),play:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.paused,n=this.audio,!t){e.next=8;break}return e.next=4,this.getVoice();case 4:n.play(),n.addEventListener("ended",(function(){n.pause(),a.paused=n.paused}),!1),e.next=9;break;case 8:n.pause();case 9:this.paused=n.paused;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),download:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getVoice();case 2:Ct(this.blobUrl,"音频");case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},computed:{iconType:function(){return this.paused?"caret-right":"pause"}},watch:{}},Dt=Rt,It=(n("c350"),Object(c["a"])(Dt,wt,jt,!1,null,"7ebec8b0",null)),Pt=It.exports,$t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-upload",{attrs:{name:"file",action:"https://up.qiniup.com",beforeUpload:e.beforeUpload,data:e.data,fileList:e.fileList,remove:e.handleRemove,multiple:!0,showUploadList:!1},on:{change:e.handleChange}},[n("a-button",{attrs:{disabled:e.loading||e.uploading,loading:e.loading}},[e.loading?e._e():n("a-icon",{attrs:{type:"upload"}}),e._v("\n      "+e._s(e.loading?"加载中":"选择")+"\n    ")],1)],1),n("a-button",{staticStyle:{"margin-top":"16px","margin-left":"10px"},attrs:{type:"primary",disabled:0===e.fileList.length,loading:e.uploading},on:{click:e.handleUpload}},[e._v("\n    "+e._s(e.uploading?"上传中":"开始上传")+"\n  ")]),n("div",{staticClass:"content-area"},[n("a-tabs",{attrs:{defaultActiveKey:"index"},on:{change:e.handleTabChange}},[n("a-tab-pane",{key:e.indexObj.key},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:e.indexObj.icon}}),e._v("\n          "+e._s(e.indexObj.name)+"\n        ")],1),n("a-row",{attrs:{gutter:16}},e._l(e.indexObj.imgList,(function(t){return n("a-col",{attrs:{span:6}},[n("a-card",{staticStyle:{margin:"10px 0"},attrs:{hoverable:""}},[n("a-popover",{attrs:{slot:"cover",trigger:"hover",arrowPointAtCenter:"",placement:"top",overlayClassName:"img-box"},slot:"cover"},[n("template",{slot:"content"},[n("img",{staticClass:"preview-img",attrs:{slot:"cover",alt:t.name,src:t.url},slot:"cover"})]),n("img",{attrs:{alt:t.name,src:t.url}})],2),n("template",{staticClass:"ant-card-actions",slot:"actions"},[n("a-popover",{attrs:{trigger:"click"},on:{visibleChange:function(){return e.edit(t)}},model:{value:t.visible,callback:function(n){e.$set(t,"visible",n)},expression:"item.visible"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("a-form",[n("a-form-item",[n("a-input",{attrs:{placeholder:"名称"},model:{value:t.addressStr,callback:function(n){e.$set(t,"addressStr",n)},expression:"item.addressStr"}})],1)],1)],1),n("a-icon",{attrs:{type:"edit"}})],1),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteItem(t.key)}}},[n("a-icon",{attrs:{type:"delete"}})],1),n("a-icon",{attrs:{type:"ellipsis"},on:{click:e.ellipsis}})],1),n("a-card-meta",[n("template",{slot:"title"},[e._v("\n                  "+e._s(t.address)+"\n                ")])],2)],2)],1)})),1)],1),n("a-tab-pane",{key:e.albumObj.key},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:e.albumObj.icon}}),e._v("\n          "+e._s(e.albumObj.name)+"\n        ")],1),n("div",{staticStyle:{width:"95%"}},e._l(e.albumObj.imgList,(function(t){return n("a-timeline",{attrs:{mode:"right"}},[n("a-timeline-item",[n("div",{staticClass:"flex-row",staticStyle:{"margin-left":"40px"},attrs:{slot:"dot"},slot:"dot"},[n("a-icon",{staticStyle:{"font-size":"16px"},attrs:{type:"clock-circle-o"}}),n("span",{staticClass:"ml5"},[e._v(e._s(t.name))])],1),n("a-row",{attrs:{gutter:16}},e._l(t.list,(function(t){return n("a-col",{attrs:{span:6}},[n("a-card",{staticStyle:{margin:"10px 0"},attrs:{hoverable:""}},[n("a-popover",{attrs:{slot:"cover",trigger:"hover",arrowPointAtCenter:"",placement:"top",overlayClassName:"img-box"},slot:"cover"},[n("template",{slot:"content"},[n("img",{staticClass:"preview-img",attrs:{slot:"cover",alt:t.name,src:t.url},slot:"cover"})]),n("img",{attrs:{alt:t.name,src:t.url}})],2),n("template",{staticClass:"ant-card-actions",slot:"actions"},[n("a-popover",{attrs:{trigger:"click"},on:{visibleChange:function(){return e.edit(t)}},model:{value:t.visible,callback:function(n){e.$set(t,"visible",n)},expression:"item.visible"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("a-form",[n("a-form-item",[n("a-input",{attrs:{placeholder:"地址"},model:{value:t.addressStr,callback:function(n){e.$set(t,"addressStr",n)},expression:"item.addressStr"}})],1),n("a-form-item",[n("a-input",{attrs:{placeholder:"评级"},model:{value:t.grade,callback:function(n){e.$set(t,"grade",n)},expression:"item.grade"}})],1)],1)],1),n("a-icon",{attrs:{type:"edit"}})],1),n("a-icon",{attrs:{type:t.locked?"lock":"unlock"},on:{click:function(n){return e.toggleLock(t)}}}),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteItem(t.key)}}},[n("a-icon",{attrs:{type:"delete"}})],1)],1),n("a-card-meta",[n("template",{slot:"title"},[e._v("\n                        "+e._s(t.address)+"\n                      ")])],2)],2)],1)})),1)],1)],1)})),1)]),n("a-tab-pane",{key:e.canonObj.key},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:e.canonObj.icon}}),e._v("\n          "+e._s(e.canonObj.name)+"\n        ")],1),n("a-row",{attrs:{gutter:16}},e._l(e.canonObj.imgList,(function(t){return n("a-col",{attrs:{span:6}},[n("a-card",{staticStyle:{margin:"10px 0"},attrs:{hoverable:""}},[n("a-popover",{attrs:{slot:"cover",trigger:"hover",arrowPointAtCenter:"",placement:"top",overlayClassName:"img-box"},slot:"cover"},[n("template",{slot:"content"},[n("img",{staticClass:"preview-img",attrs:{slot:"cover",alt:t.name,src:t.url},slot:"cover"})]),n("img",{attrs:{alt:t.name,src:t.url}})],2),n("template",{staticClass:"ant-card-actions",slot:"actions"},[n("a-icon",{attrs:{type:"apple"},on:{click:function(n){return e.onIndex(t)}}}),n("a-icon",{attrs:{type:"instagram"},on:{click:function(n){return e.onAlbum(t)}}}),n("a-popconfirm",{attrs:{title:"确认要删除?",okText:"确认",cancelText:"取消"},on:{confirm:function(){return e.deleteItem(t.key)}}},[n("a-icon",{attrs:{type:"delete"}})],1)],1),n("a-card-meta",[n("template",{slot:"title"},[e._v("\n                  "+e._s(t.address)+"\n                ")])],2)],2)],1)})),1)],1)],1)],1),n("div",{staticStyle:{"text-align":"center"}},[n("a-spin",{attrs:{spinning:e.curPagination.spinning}},[e.curPagination.isNoMore||e.curPagination.spinning?e._e():n("a-button",{attrs:{type:"link"},on:{click:e.loadData}},[e._v("加载更多\n      ")])],1)],1)],1)},Lt=[],At=(n("6762"),n("2fdb"),n("20d6"),"https://net.songxingguo.workers.dev");function Et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.DateTime,n=e.ExposureTime,a=e.FNumber,r=e.FocalLength,i=e.Model,o=e.ISOSpeedRatings;return{dateTime:t.val,exposureTime:n.val,fNumber:a.val,focalLength:r.val,model:i.val,ISO:o.val}}var Nt=function(){function e(){Object(Ve["a"])(this,e)}return Object(Fe["a"])(e,null,[{key:"getImgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.prefix,n=e.marker,a=void 0===n?"":n,r=e.limit,i=void 0===r?10:r;return $.get("".concat(At,"/calbum/imgs?marker=").concat(a,"&limit=").concat(i,"&prefix=").concat(t)).then((function(e){var t=e.data;return t}))}},{key:"getImgExif",value:function(e){return k.a.get("".concat(e,"?exif")).then((function(e){var t=e.data;return Et(t)}))}},{key:"uploadToken",value:function(){return $.get("".concat(At,"/album/token")).then((function(e){var t=e.data;return t}))}},{key:"edit",value:function(e,t){return $.get("".concat(At,"/album/edit?key=").concat(e,"&deskey=").concat(t)).then((function(e){var t=e.data;return t}))}},{key:"copy",value:function(e,t){return $.get("".concat(At,"/album/copy?key=").concat(e,"&deskey=").concat(t)).then((function(e){var t=e.data;return t}))}},{key:"delete",value:function(e){return $.get("".concat(At,"/album/delete?key=").concat(e)).then((function(e){var t=e.data;return t}))}},{key:"check",value:function(e){return $.get("".concat(At,"/album/check?key=").concat(e)).then((function(e){var t=e.data;return t}))}},{key:"batchCheck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return $.post("".concat(At,"/album/batchCheck"),{keys:e}).then((function(e){var t=e.data;return t}))}},{key:"upload",value:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="https://up.qiniup.com",e.abrupt("return",k.a.post(n,t,{headers:{"Content-Type":'multipart/form-data"'}}).then((function(e){var t=e.data;return t})));case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Ut=n("c1df"),zt=n.n(Ut);n("6f45");function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){Object(g["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.marker,n=void 0===t?"":t,a=e.spinning,r=void 0!==a&&a,i=e.isNoMore,o=void 0!==i&&i,s=e.limit,c=void 0===s?50:s;return{marker:n,spinning:r,isNoMore:o,limit:c}}function Ft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=void 0===t?"":t,a=e.key,r=void 0===a?"":a,i=e.icon,o=void 0===i?"":i,s=e.imgList,c=void 0===s?[]:s,u=e.data,l=void 0===u?[]:u,d=e.pagination,f=void 0===d?{}:d;return{name:n,key:r,icon:o,imgList:c,data:l,pagination:f}}var Jt={data:function(){return{fileInfo:{},data:{},spinning:!1,prefix:"index",tabList:[Ft({name:"精选",key:"index",icon:"apple",pagination:Vt()}),Ft({name:"相册",key:"album",icon:"instagram",pagination:Vt({limit:100})}),Ft({name:"相机",key:"canon",icon:"chrome",pagination:Vt({limit:500})})],uploadToken:"",fileList:[],uploading:!1,loading:!1}},components:{},created:function(){},mounted:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loadData();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),destroyed:function(){},methods:{handleTabChange:function(e){this.prefix=e,0===this.curTab.imgList.length&&this.loadData()},refreshData:function(e){var t=e.key,n=e.newItem,a=e.prefix;a=a||this.prefix;var r=this.tabList.find((function(e){var t=e.key;return t===a})).data;if(t){var i=r.findIndex((function(e){return e.key===t}));n?r.splice(i,1,n):r.splice(i,1)}else r.unshift(n);var o=this.handleImg(r,a);this.tabList.find((function(e){var t=e.key;return t===a})).imgList=o,this.tabList.find((function(e){var t=e.key;return t===a})).data=r},loadData:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i,o,s,c,u,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.spinning,n=this.curPagination,a=n.marker,r=n.limit,i=n.isNoMore,!t&&!i){e.next=5;break}return e.abrupt("return");case 5:return this.curPagination.spinning=!0,o=this.prefix,e.next=9,Nt.getImgs({prefix:o,limit:r,marker:a});case 9:s=e.sent,c=s.marker,u=s.data,l=this.curTab.data,l.push.apply(l,Object(Z["a"])(u)),d=this.handleImg(l,o),this.curTab.imgList=d,this.curTab.data=l,this.curPagination.marker=c,this.curPagination.spinning=!1,c||(this.curPagination.isNoMore=!0),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](0),console.error(e.t0);case 25:case"end":return e.stop()}}),e,this,[[0,22]])})));function t(){return e.apply(this,arguments)}return t}(),handleImg:function(e,t){var n=this;switch(t){case"index":return e.map((function(e){return n.handleIndex(e)}));case"album":return this.chunkList(e.map((function(e){return n.handleAlbum(e)})));case"canon":return e.map((function(e){return n.handleCanon(e)}))}},handleIndex:function(e){var t=e.address,n=e.grade,a=void 0===n?"":n,r=e.url;return Mt({},e,{name:"",url:"".concat(r,"/watermark"),address:t.replace(/-/g,"·"),addressStr:t.replace(/-/g,"，"),grade:a,visible:!1})},handleAlbum:function(e){var t=e.address,n=e.grade,a=void 0===n?"":n,r=e.url;return Mt({},e,{name:"",url:"".concat(r,"/watermark"),address:t.replace(/-/g,"·"),addressStr:t.replace(/-/g,"，"),grade:a,visible:!1})},handleCanon:function(e){var t=e.address,n=e.grade,a=void 0===n?"":n,r=e.url;return Mt({},e,{name:"",url:"".concat(r,"/mobile"),address:t,addressStr:t,grade:a,visible:!1})},chunkList:function(e){if(Array.isArray(e)){for(var t=2019,n=this.moment().years(),a=[],r=function(t){var n=e.filter((function(e){var n=e.key;return n.includes(t)}));0!==n.length&&a.push({name:t,list:n})},i=n;i>=t;i--)r(i);return a}},toggleLock:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.locked,a=t.key,r=t.url,i=a.split("/"),o=i[0],s=i[i.length-1],c=[o,"".concat(n?0:1),s].join("/"),e.prev=5,e.next=8,Nt.edit(a,c);case 8:this.$message.success("".concat(n?"解锁成功":"上锁成功"),1),this.refreshData({key:a,newItem:Mt({},t,{url:r.replace("/watermark",""),locked:!n})}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](5),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[5,12]])})));function t(t){return e.apply(this,arguments)}return t}(),edit:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.visible,a=t.key,r=t.url,i=t.addressStr,!n){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.t0=Nt,e.t1=a,e.next=8,this.genDesKey(t);case 8:return e.t2=e.sent,e.next=11,e.t0.edit.call(e.t0,e.t1,e.t2);case 11:this.$message.success("编辑成功",1),this.refreshData({key:a,newItem:Mt({},t,{url:r.replace("/watermark",""),address:i.replace("，","·")})}),e.next=18;break;case 15:e.prev=15,e.t3=e["catch"](3),console.error(e.t3);case 18:case"end":return e.stop()}}),e,this,[[3,15]])})));function t(t){return e.apply(this,arguments)}return t}(),genDesKey:function(e){var t=e.prefix,n=e.key;switch(t){case"index":return this.genIndexDesKey(e,t);case"album":return this.genAlbumDesKey(e,t);case"canon":return n}},genIndexDesKey:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.addressStr,r=t.grade,i=t.url,e.next=3,Nt.getImgExif(i);case 3:return o=e.sent,s=o.dateTime,s=zt()(s,"YYYY:MM:DD HH:mm:ss").format("YYYYMMDDHHmm"),e.abrupt("return","".concat(n,"/").concat(s,"_").concat(a.replace(/，/g,"-"),"_").concat(r));case 7:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),genAlbumDesKey:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,i,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.addressStr,r=t.grade,i=t.url,o=t.locked,e.next=3,Nt.getImgExif(i);case 3:return s=e.sent,c=s.dateTime,c=zt()(c,"YYYY:MM:DD HH:mm:ss").format("YYYYMMDDHHmm"),e.abrupt("return",[n,"".concat(o?1:0),"".concat(c,"_").concat(a.replace(/，/g,"-"),"_").concat(r)].join("/"));case 7:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),deleteItem:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Nt.delete(t);case 3:this.$message.success("删除成功",1),this.refreshData({key:t}),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}(),ellipsis:function(){this.$message.info("功能正在开发中",1)},onIndex:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n=t.key,a=t.url,r="index",e.next=5,this.genIndexDesKey(Mt({},t,{url:a.replace("/mobile","/watermark")}),r);case 5:return i=e.sent,e.next=8,Nt.copy(n,i);case 8:this.$message.success("拷贝成功",1),this.refreshData({prefix:r,newItem:Mt({},t,{url:a.replace("/mobile",""),key:i})}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(t){return e.apply(this,arguments)}return t}(),onAlbum:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(t){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n=t.key,a=t.url,r="album",e.next=5,this.genAlbumDesKey(Mt({},t,{url:a.replace("/mobile","/watermark")}),r);case 5:return i=e.sent,e.next=8,Nt.copy(n,i);case 8:this.$message.success("拷贝成功",1),this.refreshData({prefix:r,newItem:Mt({},t,{url:a.replace("/mobile",""),key:i})}),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(t){return e.apply(this,arguments)}return t}(),beforeUpload:function(e){return this.fileList=[].concat(Object(Z["a"])(this.fileList),[e]),this.loading=!0,!1},handleUpload:function(){var e=Object(q["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=this.fileList,n=t.map((function(e){return"canon/".concat(e.name)})),e.next=5,Nt.batchCheck(n);case 5:return a=e.sent,r=a.keys,this.loading=!1,this.uploading=!0,e.next=11,Nt.uploadToken();case 11:return i=e.sent,o=t.filter((function(e){return r.findIndex((function(t){return t=="canon/".concat(e.name)}))>=0})),e.next=15,Promise.all(o.map((function(e){var t=e.name,n=new FormData;return n.append("file",e),n.append("token",i),n.append("key","canon/".concat(t)),Nt.upload(n)})));case 15:this.fileList=[],this.uploading=!1,this.$message.success("".concat(o.length,"个图片上传成功")),e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](0),e.t0.message,this.uploading=!1;case 24:case"end":return e.stop()}}),e,this,[[0,20]])})));function t(){return e.apply(this,arguments)}return t}(),handleChange:function(e){"done"===e.file.status?this.$message.success("".concat(e.file.name," 上传成功")):"error"===e.file.status&&this.$message.error("".concat(e.file.name," 上传失败"))},handleRemove:function(e){var t=this.fileList.indexOf(e),n=this.fileList.slice();n.splice(t,1),this.fileList=n}},computed:{indexObj:function(){return this.tabList[0]},albumObj:function(){return this.tabList[1]},canonObj:function(){return this.tabList[2]},curTab:{get:function(){var e=this;return this.tabList.find((function(t){var n=t.key;return n===e.prefix}))},set:function(e){var t=this,n=this.tabList.findIndex((function(e){var n=e.key;return n===t.prefix}));this.tabList[n]=e}},curPagination:{get:function(){var e=this;return this.tabList.find((function(t){var n=t.key;return n===e.prefix})).pagination},set:function(e){var t=this,n=this.tabList.findIndex((function(e){var n=e.key;return n===t.prefix}));this.tabList[n].pagination=e}}},watch:{}},Gt=Jt,Kt=(n("fecb"),Object(c["a"])(Gt,$t,Lt,!1,null,"8ce2ca12",null)),Yt=Kt.exports;a["a"].use(h["a"]);var Ht=new h["a"]({mode:"history",routes:[{path:"/login",component:xt},{path:"",meta:{requireAuth:!0},component:N,children:[{path:"/demo",meta:{requireAuth:!0},component:J},{path:"/md2json",meta:{requireAuth:!0},component:B},{path:"/goodsType",meta:{requireAuth:!0},component:se},{path:"/goodsExamine",meta:{requireAuth:!0},component:Se},{path:"/isStudentExamine",meta:{requireAuth:!0},component:ze},{path:"/sites",meta:{requireAuth:!0},component:nt},{path:"/sites/create",meta:{requireAuth:!0},component:mt},{path:"/sites/:id/edit",meta:{requireAuth:!0},component:mt},{path:"/voice",meta:{requireAuth:!0},component:Pt},{path:"/album",meta:{requireAuth:!0},component:Yt},{path:"*",meta:{requireAuth:!0},component:nt}]}]}),Wt=n("ec7e"),Bt=n.n(Wt),Xt=n("a7fe"),Qt=n.n(Xt),Zt=n("2ef0"),en=n.n(Zt),tn={appId:"hJlVtqYMU2inTJ6WDsLruwRm-gzGzoHsz",appKey:"ist6rnuv2KfBpkdEng22uNA0"},nn=tn.appId,an=tn.appKey,rn=new m["Realtime"]({appId:"hJlVtqYMU2inTJ6WDsLruwRm-gzGzoHsz",appKey:"ist6rnuv2KfBpkdEng22uNA0"});a["a"].use(Qt.a,k.a),p.a.init(nn,an),a["a"].prototype.AV=p.a,a["a"].prototype.realtime=rn,a["a"].config.productionTip=!1,a["a"].prototype._=en.a,a["a"].prototype.moment=zt.a,a["a"].use(d["a"]),a["a"].use(Bt.a,0),Ht.beforeEach((function(e,t,n){e.meta.requireAuth?p.a.User.current()?n():n({path:"/login",query:{redirect:e.fullPath}}):n()})),window.$VueRouter=Ht,new a["a"]({router:Ht,render:function(e){return e(l)}}).$mount("#app")},"5c72":function(e,t,n){"use strict";var a=n("4998"),r=n.n(a);r.a},"70ea":function(e,t,n){},"72ed":function(e,t,n){"use strict";var a=n("e2dc"),r=n.n(a);r.a},7627:function(e,t,n){},"7b6f":function(e,t,n){},"86a1":function(e,t,n){"use strict";var a=n("7b6f"),r=n.n(a);r.a},"8fb2":function(e,t,n){},9806:function(e,t,n){"use strict";var a=n("4361"),r=n.n(a);r.a},a3f7:function(e,t,n){},aa74:function(e,t,n){},b8eb:function(e,t,n){"use strict";var a=n("8fb2"),r=n.n(a);r.a},bed4:function(e,t,n){},c350:function(e,t,n){"use strict";var a=n("e3bf"),r=n.n(a);r.a},ce00:function(e,t,n){},db00:function(e,t,n){"use strict";var a=n("ce00"),r=n.n(a);r.a},e2dc:function(e,t,n){},e3bf:function(e,t,n){},e823:function(e,t,n){"use strict";var a=n("4236"),r=n.n(a);r.a},fecb:function(e,t,n){"use strict";var a=n("0dca"),r=n.n(a);r.a}});
//# sourceMappingURL=app.2e0016c4.js.map